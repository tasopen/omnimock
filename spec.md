# 学習・模擬テストアプリ OmniMock 利用方法

本ドキュメントは、学習アプリOmniMockの動作仕様および、問題データ作成時のガイドラインをまとめたものです。
©2026 TasogarePenguin

## 1. 基本システム仕様

### 1.1 問題の読み込み
- **動的インデックス生成**: `public/data/sets/` ディレクトリ内のすべてのJSONファイルを読み込み、トップメニューを動的に生成します。
- **データ形式**: JSON形式。問題、単一/複数選択の回答、解説、カテゴリ情報を含みます。

### 1.2 学習モード
- **全問題モード**: 選択したセットの全問題をランダムな順序で出題。
- **カテゴリ別モード**: 各問題に付与された「大分類」を選択して集中的に学習。
- **タイマー機能**:
  - 全問題モード: セットに設定された標準制限時間。
  - カテゴリ別モード: `(全体の制限時間 ÷ 全問題数) × そのカテゴリの問題数` で算出される比例制限時間。

### 1.3 回答方式
- **単一選択式**: 選択肢をクリックした瞬間に正誤判定が行われます。
- **複数選択式**:
  - 選択肢をクリックしてチェック状態を切り替えます。
  - 「回答を確定する」ボタン（または `Space` キー）を押すことで正誤判定が行われます。
  - **部分点なし**: すべての正解を選択し、かつ不正解を一つも選択していない場合のみ正答となります。

### 1.4 キーボードショートカット
- **1〜6キー**: 各選択肢の選択。
- **Enterキー**: 解説表示後の「次の問題へ」の実行。
- **Spaceキー**: 複数選択式での回答確定。
- **Escキー**: 演習の中止（確認ダイアログ表示）。

---

## 2. 問題データ作成ガイドライン

質の高い学習体験を提供するため、以下の点に注意して問題を作成してください。

### 2.1 選択肢の公平性の確保 (バイアス回避)
知識がなくても「傾向」だけで正解を推測できてしまう「バイアス」を排除してください。
- **詳細度の統一**: 正解だけが極端に長かったり、補足説明（カッコ書きなど）が付いていたりしないようにします。
- **詳細度の統一**: 数値やキーワードが正解にだけ含まれているような構成を避けます。
- **問題文との重複**: 問題文の中に含まれる単語が、特定の選択肢（正解）にだけ含まれているような構成を避けます。
- **表現の統一**: 選択肢間での文末表現や用語の粒度を揃えます。

### 2.2 選択肢のシャッフル対応
アプリは提示時に**選択肢を自動でシャッフル**します。
- **正解の配置**: データ作成時は、常に**一番上の選択肢（index: 0）を正解**として配置して構いません。
- **順番依存の禁止**: 選択肢が特定の順番に依存する表現を禁止します。
  - × 「1と2の両方」「上記すべて」「以下のうちどれでもない」
  - ○ 「AとBの両方」「いずれも当てはまらない」のように、具体的な名称を使って記載してください。

### 2.3 数式の記述
- 数式は LaTeX 形式で `$...$` (インライン) または `$$...$$` (ブロック) で記述してください。MathJax により美しくレンダリングされます。
- 例: `$P(H|D) = \frac{P(D|H)P(H)}{P(D)}$`

---

## 3. 問題データのフォーマット (JSON)

新しい問題集を作成する際は、以下の形式で `public/data/sets/` にJSONファイルを保存してください。  
AIエージェントで生成する場合、出力jsonファイルが大きすぎてコンテキストを超過するかもしれません。  
例えば一つのjsonに200問入り切らない場合は50問ずつ追記していく、といった方法が有用です。  

### 3.1 全体構造
```json
{
  "metadata": {
    "title": "問題集のタイトル",
    "description": "問題集の説明文",
    "totalQuestions": 10,
    "passLine": 70,
    "timeLimit": 60
  },
  "questions": [
    // 問題オブジェクトの配列
  ]
}
```

### 3.2 メタデータのプロパティ
| キー | 型 | 内容 |
| :--- | :--- | :--- |
| `title` | string | 問題集のタイトル |
| `description` | string | 問題集の説明文 |
| `totalQuestions` | number | 出題される問題の総数 |
| `passLine` | number | 合格基準点（**パーセント指定**、例: 70 は 70%） |
| `timeLimit` | number | 制限時間（**分単位**） |

### 3.3 問題オブジェクトのプロパティ
| キー | 型 | 内容 |
| :--- | :--- | :--- |
| `id` | number | 一意のID |
| `majorCategory`| string | 大分類（カテゴリ選択メニューに使用） |
| `subCategory` | string | 小分類（任意、表示用） |
| `question` | string | 問題文（LaTeX、改行 `\n` 対応） |
| `options` | string[] | **2〜6個**の選択肢。自動でシャッフルされます。 |
| `answer` | number \| number[] | **単一選択**: 正解のインデックス(0〜)。<br>**複数選択**: 正解インデックスの配列。 |
| `explanation` | string | 回答後に表示される解説文。 |
| `table` | array[][] | (任意) 2次元配列による表データ。1行目がヘッダーになります。 |

### 3.3 具体的な記述例

#### 単一選択＋表形式
```json
{
  "id": 1,
  "majorCategory": "AIモデル",
  "question": "以下の表に基づき、適切なアルゴリズムを選べ。",
  "table": [
    ["項目", "内容"],
    ["用途", "分類"],
    ["特徴", "非線形分離可能"]
  ],
  "options": ["SVM", "線形回帰", "K-means"],
  "answer": 0,
  "explanation": "解説文をここに記述します。"
}
```

#### 複数選択式
```json
{
  "id": 2,
  "majorCategory": "ディープラーニング",
  "question": "活性化関数をすべて選べ。",
  "options": [
    "ReLU",
    "Sigmoid",
    "Adam",
    "SGD"
  ],
  "answer": [0, 1],
  "explanation": "ReLUとSigmoidは活性化関数ですが、AdamとSGDは最適化手法です。"
}
```
